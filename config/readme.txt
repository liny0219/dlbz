# 战斗指令脚本格式说明

本文件用于说明如何编写战斗指令脚本（TXT格式），包括每种指令的参数含义、取值范围及使用示例。

## 基本格式
- 每行一条指令，逗号分隔参数
- 支持 # 开头的注释行，空行自动跳过
- 指令类型区分大小写

---

## 指令类型一览表

### 战斗控制指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| BattleStart | 标记战斗开始 | `BattleStart` | `BattleStart` |
| BattleEnd | 标记战斗结束 | `BattleEnd` | `BattleEnd` |
| Attack | 执行攻击操作 | `Attack` | `Attack` |
| Run | 逃跑指令 | `Run` | `Run` |

### 角色技能指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| Role | 前排角色普攻/技能 | `Role,角色[1~4],技能[0~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `Role,1,2,1,0,0,0` |
| XRole | 后排角色普攻/技能 | `XRole,角色[1~4],技能[0~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `XRole,3,1,2,0,0,0` |
| RoleEx | 前排角色潜力切换形态技能 | `RoleEx,角色[1~4],技能[0~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `RoleEx,1,1,0,0,0,0` |
| XRoleEx | 后排角色潜力切换形态技能 | `XRoleEx,角色[1~4],技能[0~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `XRoleEx,2,2,1,0,0,0` |

### 必杀技指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| SP | 前排角色必杀技 | `SP,角色[1~4],目标角色[0~4],怪物x,怪物y` | `SP,1,0,0,0` |
| XSP | 后排角色必杀技 | `XSP,角色[1~4],目标角色[0~4],怪物x,怪物y` | `XSP,2,0,0,0` |
| EX | 前排角色EX技能 | `EX,角色[1~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `EX,1,0,0,0,0` |
| XEX | 后排角色EX技能 | `XEX,角色[1~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `XEX,2,1,0,0,0` |

### 宠物指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| Pet | 前排宠物技能 | `Pet,宠物[1~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `Pet,1,0,0,0,0` |
| XPet | 后排宠物技能 | `XPet,宠物[1~4],BP[0~3],目标角色[0~4],怪物x,怪物y` | `XPet,2,1,0,0,0` |

### 战术指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| Switch | 全员前后排交替 | `Switch` | `Switch` |
| Boost | 全体加成 | `Boost` | `Boost` |

### 状态检测指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| CheckDead | 开启角色死亡检测 | `CheckDead,角色[0~4]` | `CheckDead,0` |
| NoCheckDead | 关闭角色死亡检测 | `NoCheckDead` | `NoCheckDead` |

### 时间控制指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| Wait | 等待指定秒数 | `Wait,秒数` | `Wait,2.5` |
| Skip | 跳过指定秒数（如动画） | `Skip,秒数` | `Skip,1.0` |
| PressInRound | 长按跳过到下个战斗回合 | `PressInRound,超时秒数` | `PressInRound,5` |

### 循环控制指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| LoopS | 循环开始标记 | `LoopS` | `LoopS` |
| LoopE | 循环结束，指定循环次数 | `LoopE,次数` | `LoopE,3` |

### 其他指令
| 指令类型 | 说明 | 格式 | 示例 |
|---------|------|------|------|
| Click | 点击指定坐标 | `Click,x坐标,y坐标` | `Click,800,600` |
| ExitApp | 退出应用程序 | `ExitApp` | `ExitApp` |

---

## 详细参数说明

### 基本参数
- **角色索引**：1~4，对应前排1-4号位角色
- **技能索引**：0为普攻，1-4为对应技能槽位
- **BP倍率**：0为不加成，1-3为1-3倍BP加成
- **目标角色**：0为无目标，1-4为目标我方角色
- **怪物坐标**：x,y为敌人坐标，0,0为无目标
- **宠物索引**：1~4，对应宠物槽位
- **秒数**：浮点数，单位为秒

### 循环指令说明
- **LoopS**：标记循环开始位置，无参数
- **LoopE**：循环结束判断，参数为循环次数
  - 次数为0：无限循环
  - 次数>0：执行指定次数后退出循环
- 循环范围：从LoopS的下一条指令到LoopE之间的所有指令

---

## 综合示例

```
# 战斗流程示例
BattleStart

# 循环攻击3次
LoopS
Role,1,2,1,0,0,0
Wait,1.5
Attack
LoopE,3

# 释放必杀技
SP,2,0,0,0
Wait,2.0

# 检查死亡状态
CheckDead,0
Click,900,500

BattleEnd
```

---

## 注意事项
- 未知指令会被忽略并记录警告
- 参数不足时，未填写的参数将使用默认值
- 建议每条指令单独一行，便于调试和维护
- 循环指令不支持嵌套，请合理规划循环逻辑
